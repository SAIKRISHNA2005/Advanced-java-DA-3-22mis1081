<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:composition template="/templates/layout.xhtml">
        <ui:define name="title">Home</ui:define>
        
        <ui:define name="content">
            <f:metadata>
                <f:event type="preRenderView" listener="#{enrollmentBean.loadEnrollments}"/>
            </f:metadata>
            <!-- Content for logged-in users -->
            <ui:fragment rendered="#{not empty studentBean.currentStudent}">
                <div class="welcome-card" style="margin-top: 20px;">
                    <h2 style="color: white !important;">Welcome back, #{studentBean.currentStudent.firstName} #{studentBean.currentStudent.lastName}! ğŸ‘‹</h2>
                    <p style="color: white !important; opacity: 0.95; margin: 10px 0;">#{studentBean.currentStudent.email}</p>
                    <div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                        <h:form>
                            <h:commandButton value="ğŸ“š Browse Courses" action="courseList" 
                                            styleClass="button button-outline" style="color: white !important; border-color: white !important;"/>
                        </h:form>
                        <h:form>
                            <h:commandButton value="ğŸ“Š Dashboard" action="dashboard" 
                                            styleClass="button button-outline" style="color: white !important; border-color: white !important;"/>
                        </h:form>
                        <h:form>
                            <h:commandButton value="ğŸ‘¤ Profile" action="profile" 
                                            styleClass="button button-outline" style="color: white !important; border-color: white !important;"/>
                        </h:form>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px;">
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 10px;">ğŸ“š</div>
                        <h3 style="color: #333 !important;">#{courseBean.totalCoursesCount}</h3>
                        <p style="color: #555 !important; margin: 0;">Available Courses</p>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 10px;">âœ…</div>
                        <h3 style="color: #333 !important;">#{enrollmentBean.activeEnrollmentsCount}</h3>
                        <p style="color: #555 !important; margin: 0;">Active Enrollments</p>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 10px;">ğŸ’³</div>
                        <h3 style="color: #333 !important;">â‚¹#{paymentBean.totalSpent}</h3>
                        <p style="color: #555 !important; margin: 0;">Total Spent</p>
                    </div>
                </div>
            </ui:fragment>

            <!-- Content for non-logged-in users -->
            <ui:fragment rendered="#{empty studentBean.currentStudent}">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">
                    
                    <!-- Login Card -->
                    <div class="card">
                        <h2>ğŸ” Login</h2>
                        <h:form id="loginForm">
                            <div class="form-group">
                                <h:outputLabel for="loginEmail" value="Email Address *"/>
                                <h:inputText id="loginEmail" value="#{studentBean.loginEmail}" 
                                             required="true" requiredMessage="Email is required"
                                             styleClass="form-control"
                                             placeholder="Enter your email"/>
                                <h:message for="loginEmail" styleClass="error"/>
                            </div>

                            <div class="form-group">
                                <h:outputLabel for="loginPassword" value="Password *"/>
                                <h:inputSecret id="loginPassword" value="#{studentBean.loginPassword}" 
                                              required="true" requiredMessage="Password is required"
                                              styleClass="form-control"
                                              placeholder="Enter your password"/>
                                <h:message for="loginPassword" styleClass="error"/>
                            </div>

                            <h:commandButton value="Login" action="#{studentBean.login}" 
                                            styleClass="button" style="width: 100%; margin-top: 10px;"/>
                        </h:form>
                    </div>

                    <!-- Registration Card -->
                    <div class="card">
                        <h2>âœ¨ New Student?</h2>
                        <p style="color: #555 !important; margin-bottom: 30px;">
                            Create an account to enroll in courses and track your learning progress.
                        </p>
                        <h:form>
                            <h:commandButton value="Create Account" action="register" 
                                            styleClass="button button-success" style="width: 100%; margin-bottom: 15px;"/>
                            <h:commandButton value="Browse Courses" action="courseList" 
                                            styleClass="button" style="width: 100%; background: var(--primary-color) !important; color: white !important;"/>
                        </h:form>
                    </div>

                </div>
            </ui:fragment>

            <!-- Features Section (shown for all users) -->
            <div class="card" style="margin-top: 30px; text-align: center;">
                <h2>Why Choose Us?</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px;">
                    <div>
                        <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ“š</div>
                        <h3 style="color: #333 !important;">Wide Course Selection</h3>
                        <p style="color: #555 !important;">Choose from a variety of courses</p>
                    </div>
                    <div>
                        <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ‘¨â€ğŸ«</div>
                        <h3 style="color: #333 !important;">Expert Instructors</h3>
                        <p style="color: #555 !important;">Learn from industry professionals</p>
                    </div>
                    <div>
                        <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ’³</div>
                        <h3 style="color: #333 !important;">Secure Payments</h3>
                        <p style="color: #555 !important;">Multiple payment options available</p>
                    </div>
                    <div>
                        <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ“Š</div>
                        <h3 style="color: #333 !important;">Track Progress</h3>
                        <p style="color: #555 !important;">Monitor your enrollments and payments</p>
                    </div>
                </div>
            </div>
        </ui:define>
    </ui:composition>

</html>
