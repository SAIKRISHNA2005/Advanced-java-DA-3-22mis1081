<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:composition template="/templates/layout.xhtml">
        <ui:define name="title">My Profile</ui:define>
        
        <ui:define name="content">
            <ui:fragment rendered="#{not empty studentBean.currentStudent}">
                <f:event type="preRenderView" listener="#{studentBean.loadProfileData()}"/>
                
                <div class="card" style="max-width: 700px; margin: 20px auto;">
                    <h2>ðŸ‘¤ My Profile</h2>
                    
                    <div class="detail-section" style="margin-bottom: 30px;">
                        <h3 style="color: #333 !important;">Account Information</h3>
                        <div class="detail-row">
                            <span class="detail-label" style="color: #555 !important;">Email:</span>
                            <span class="detail-value" style="color: #333 !important;">#{studentBean.currentStudent.email}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label" style="color: #555 !important;">Student ID:</span>
                            <span class="detail-value" style="color: #333 !important;">#{studentBean.currentStudent.studentId}</span>
                        </div>
                    </div>

                    <h:form id="profileForm">
                        <h3 style="color: #333 !important;">Personal Information</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div class="form-group">
                                <h:outputLabel for="firstName" value="First Name *"/>
                                <h:inputText id="firstName" value="#{studentBean.firstName}" 
                                            required="true" requiredMessage="First name is required"
                                            styleClass="form-control"/>
                                <h:message for="firstName" styleClass="error"/>
                            </div>

                            <div class="form-group">
                                <h:outputLabel for="lastName" value="Last Name *"/>
                                <h:inputText id="lastName" value="#{studentBean.lastName}" 
                                            required="true" requiredMessage="Last name is required"
                                            styleClass="form-control"/>
                                <h:message for="lastName" styleClass="error"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <h:outputLabel for="phone" value="Phone Number"/>
                            <h:inputText id="phone" value="#{studentBean.phone}" 
                                        styleClass="form-control" placeholder="+1 234 567 8900"/>
                            <h:message for="phone" styleClass="error"/>
                        </div>

                        <div class="form-group">
                            <h:outputLabel for="address" value="Address"/>
                            <h:inputText id="address" value="#{studentBean.address}" 
                                        styleClass="form-control" placeholder="123 Main St, City, State"/>
                            <h:message for="address" styleClass="error"/>
                        </div>

                        <div style="margin-top: 30px; display: flex; gap: 10px;">
                            <h:commandButton value="ðŸ’¾ Save Changes" action="#{studentBean.updateProfile}" 
                                            styleClass="button button-success" style="flex: 1;"/>
                            <h:commandButton value="Cancel" action="dashboard" 
                                            styleClass="button button-secondary" style="flex: 1;"/>
                        </div>
                    </h:form>
                </div>
            </ui:fragment>

            <ui:fragment rendered="#{empty studentBean.currentStudent}">
                <div class="card">
                    <div class="empty-state">
                        <p style="font-size: 1.2rem;">Please login to view your profile</p>
                        <h:form>
                            <h:commandButton value="Go to Login" action="home" 
                                            styleClass="button" style="margin-top: 20px;"/>
                        </h:form>
                    </div>
                </div>
            </ui:fragment>
        </ui:define>
    </ui:composition>

</html>

